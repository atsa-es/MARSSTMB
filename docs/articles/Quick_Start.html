<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Start • marssTMB</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start">
<meta property="og:description" content="marssTMB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">marssTMB</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Quick_Start.html">Quick Start</a>
    </li>
    <li>
      <a href="../articles/MARSS_TMB.html">Dynamic Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/dfaTMB.html">dfaTMB: Dynamic Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/Optimization.html">Optimization discussion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atsa-es/marssTMB/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quick Start</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atsa-es/marssTMB/blob/HEAD/vignettes/Quick_Start.Rmd" class="external-link"><code>vignettes/Quick_Start.Rmd</code></a></small>
      <div class="hidden name"><code>Quick_Start.Rmd</code></div>

    </div>

    
    
<p>The {MARSS} package fits multivariate autoregressive state-space
(MARSS) models and the {marssTMB} is a companion package that allows
fast model fitting via TMB. MARSS models take the form: <span class="math display">\[\begin{equation}\label{eqn:marss}
\begin{gathered}
\mbox{$\mathbf x$}_t = \mbox{$\mathbf B$}_t\mbox{$\mathbf x$}_{t-1} +
\mbox{$\mathbf u$}_t + \mbox{$\mathbf C$}_t\mbox{$\mathbf c$}_t +
\mbox{$\mathbf G$}_t\mbox{$\mathbf w$}_t, \text{ where } \mbox{$\mathbf
w$}_t \sim \,\textrm{MVN}(0,\mbox{$\mathbf Q$}_t)\\
\mbox{$\mathbf y$}_t = \mbox{$\mathbf Z$}_t\mbox{$\mathbf x$}_t +
\mbox{$\mathbf a$}_t + \mbox{$\mathbf D$}_t\mbox{$\mathbf d$}_t +
\mbox{$\mathbf H$}_t\mbox{$\mathbf v$}_t, \text{ where } \mbox{$\mathbf
v$}_t \sim \,\textrm{MVN}(0,\mbox{$\mathbf R$}_t)\\
\mbox{$\mathbf x$}_1 \sim \,\textrm{MVN}(\pmb{\pi},\pmb{\Lambda}) \text{
or } \mbox{$\mathbf x$}_0 \sim \,\textrm{MVN}(\pmb{\pi},\pmb{\Lambda})
\end{gathered}
\end{equation}\]</span> <span class="math inline">\(\mbox{$\mathbf
c$}\)</span> and <span class="math inline">\(\mbox{$\mathbf d$}\)</span>
are inputs (aka, exogenous variables or covariates or indicator
variables) and must have no missing values. They are not treated as
`data’ in the likelihood but as inputs.</p>
<p>Example: a mean-reverting random walk model with three observation
time series: <span class="math display">\[\begin{gather*}
\begin{bmatrix}x_1\\ x_2\end{bmatrix}_t
= \begin{bmatrix}b&amp;0\\ 0&amp;b\end{bmatrix}
\begin{bmatrix}x_1\\ x_2\end{bmatrix}_{t-1}
+ \begin{bmatrix}w_1\\ w_2\end{bmatrix}_t, \quad
\begin{bmatrix}w_1\\ w_2\end{bmatrix}_t \sim
\,\textrm{MVN}\begin{pmatrix}\begin{bmatrix}0\\0\end{bmatrix},\begin{bmatrix}q_{11}&amp;q_{12}\\
q_{12}&amp;q_{22}\end{bmatrix} \end{pmatrix},
\\
\begin{bmatrix}x_1\\ x_2\end{bmatrix}_0 \sim
\,\textrm{MVN}\begin{pmatrix}\begin{bmatrix}0\\
0\end{bmatrix},\begin{bmatrix}1&amp;0\\ 0&amp;1\end{bmatrix}
\end{pmatrix} \\
\\
\begin{bmatrix}y_1\\y_2\\y_3\end{bmatrix}_t
= \begin{bmatrix}1&amp;1\\ 0&amp;1\\ 1&amp;0\end{bmatrix}
\begin{bmatrix}x_1\\x_2\end{bmatrix}_t
+ \begin{bmatrix}v_1\\ v_2\\ v_3\end{bmatrix}_t,\quad
\begin{bmatrix}v_1\\ v_2\\ v_3\end{bmatrix}_t \sim
MVN\begin{pmatrix}\begin{bmatrix}a_1\\ 0\\ 0\end{bmatrix},
\begin{bmatrix}r_{11}&amp;0&amp;0\\ 0&amp;r&amp;0\\
0&amp;0&amp;r\end{bmatrix} \end{pmatrix}
\end{gather*}\]</span></p>
<p>To fit a MARSS model with the {MARSS} package, we translate the
mathematical model written in matrix form into equivalent matrices (or
arrays if time-varying) in code. Matrices that combine fixed and
estimated values are specified using a list matrix with numerical values
for fixed values and character names for the estimated values.</p>
<p>The model above is written as</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"b"</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="st">"b"</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">U1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"q11"</span>,<span class="st">"q12"</span>,<span class="st">"q12"</span>,<span class="st">"q22"</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Z1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">A1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"a1"</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">R1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"r11"</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="st">"r"</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="st">"r"</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">pi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>; <span class="va">V1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">model.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>B<span class="op">=</span><span class="va">B1</span>,U<span class="op">=</span><span class="va">U1</span>,Q<span class="op">=</span><span class="va">Q1</span>,Z<span class="op">=</span><span class="va">Z1</span>,A<span class="op">=</span><span class="va">A1</span>,R<span class="op">=</span><span class="va">R1</span>,x0<span class="op">=</span><span class="va">pi1</span>,V0<span class="op">=</span><span class="va">V1</span>,tinitx<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Notice the one-to-one correspondence between the model in and the
math version of the model. The matrix names in the model list must be B,
U, Q, Z, A, R, x0, V0. The <code>tinitx</code> element tells MARSS
whether the initial state for <span class="math inline">\(x\)</span> is
at <span class="math inline">\(t=1\)</span> (<code>tinitx=1</code>) or
<span class="math inline">\(t=0\)</span> (<code>tinitx=0</code>). The
data must be entered as a <span class="math inline">\(n \times
T\)</span> matrix, or a ts object or vector (which will be converted to
a <span class="math inline">\(n \times T\)</span> matrix). MARSS has a
number of text shortcuts for common parameter forms, such as ``diagonal
and unequal’’; see the User Guide for the possible shortcuts. You can
leave off matrix names and the defaults will be used. See
[MARSS::MARSS.marxss()] for the defaults.</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Harbor seal counts:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atsa-es.github.io/MARSS/" class="external-link">MARSS</a></span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">harborSealWA</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span> <span class="co"># remove the year row</span></span></code></pre></div>
<p>Fit but set B to identity.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atsa-es.github.io/marssTMB">marssTMB</a></span><span class="op">)</span></span>
<span><span class="va">model.list</span><span class="op">$</span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MARSS/man/MARSS.html" class="external-link">MARSS</a></span><span class="op">(</span><span class="va">dat</span>, model<span class="op">=</span><span class="va">model.list</span>, method<span class="op">=</span><span class="st">"TMB"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MARSS fit is</span></span>
<span><span class="co">#&gt; Estimation method: TMB </span></span>
<span><span class="co">#&gt; Estimation converged in 50 iterations. </span></span>
<span><span class="co">#&gt; Log-likelihood: -30.28457 </span></span>
<span><span class="co">#&gt; AIC: 72.56914   AICc: 74.39523   </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;       Estimate</span></span>
<span><span class="co">#&gt; A.a1  -8.28014</span></span>
<span><span class="co">#&gt; R.r11  0.12333</span></span>
<span><span class="co">#&gt; R.r    0.00199</span></span>
<span><span class="co">#&gt; Q.q11  0.01374</span></span>
<span><span class="co">#&gt; Q.q12  0.01765</span></span>
<span><span class="co">#&gt; Q.q22  0.02679</span></span>
<span><span class="co">#&gt; Initial states (x0) defined at t=0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standard errors have not been calculated. </span></span>
<span><span class="co">#&gt; Use MARSSparamCIs to compute CIs and bias estimates.</span></span></code></pre></div>
<p>The <span class="math inline">\(\mbox{$\mathbf R$}\)</span>, <span class="math inline">\(\mbox{$\mathbf Q$}\)</span> and <span class="math inline">\(\pmb{\Lambda}\)</span> variances can be set to
zero to specify partially deterministic systems. This allows you to
write MAR(p) models in MARSS form for example. See the User Guide for
examples.</p>
</div>
<div class="section level2">
<h2 id="parameter-estimates">Parameter estimates<a class="anchor" aria-label="anchor" href="#parameter-estimates"></a>
</h2>
<p>The main function is which returns a vector of only the estimated
parameters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"vector"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         A.a1        R.r11          R.r        Q.q11        Q.q12        Q.q22 </span></span>
<span><span class="co">#&gt; -8.280136930  0.123328694  0.001993932  0.013736566  0.017652326  0.026788781</span></span></code></pre></div>
<p>You can include <code>type="matrix"</code> to the full parameter
matrices.</p>
<p>You can get a pretty version of the estimates with SEs and CIs
with</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;    term     estimate   std.error      conf.low      conf.up</span></span>
<span><span class="co">#&gt; 1  A.a1 -8.280136930 0.084183729 -8.4451340074 -8.115139852</span></span>
<span><span class="co">#&gt; 2 R.r11  0.123328694 0.042475916  0.0400774276  0.206579960</span></span>
<span><span class="co">#&gt; 3   R.r  0.001993932 0.001274834 -0.0005046981  0.004492561</span></span>
<span><span class="co">#&gt; 4 Q.q11  0.013736566 0.005764361  0.0024386264  0.025034505</span></span>
<span><span class="co">#&gt; 5 Q.q12  0.017652326 0.007015187  0.0039028114  0.031401841</span></span>
<span><span class="co">#&gt; 6 Q.q22  0.026788781 0.010338969  0.0065247747  0.047052787</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimated-states">Estimated states<a class="anchor" aria-label="anchor" href="#estimated-states"></a>
</h2>
<p>To get the estimated states (the expected value), use</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/tsSmooth.html" class="external-link">tsSmooth</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   .rownames t .estimate        .se</span></span>
<span><span class="co">#&gt; 1        X1 1  6.648262 0.04119439</span></span>
<span><span class="co">#&gt; 2        X1 2  6.761252 0.11033567</span></span>
<span><span class="co">#&gt; 3        X1 3  6.874243 0.13179260</span></span>
<span><span class="co">#&gt; 4        X1 4  6.987233 0.13146468</span></span>
<span><span class="co">#&gt; 5        X1 5  7.100223 0.10915577</span></span>
<span><span class="co">#&gt; 6        X1 6  7.213214 0.03557170</span></span></code></pre></div>
<p>If you want a matrix of the states, you can use
<code>fit$states</code>.</p>
</div>
<div class="section level2">
<h2 id="fitted-values">Fitted values<a class="anchor" aria-label="anchor" href="#fitted-values"></a>
</h2>
<p>The fitted values are the model estimates for the data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   .rownames t        y   .fitted</span></span>
<span><span class="co">#&gt; 1       SJF 1 6.033086 -8.280137</span></span>
<span><span class="co">#&gt; 2       SJF 2       NA  5.098680</span></span>
<span><span class="co">#&gt; 3       SJF 3       NA  5.098680</span></span>
<span><span class="co">#&gt; 4       SJF 4       NA  5.098680</span></span>
<span><span class="co">#&gt; 5       SJF 5       NA  5.098680</span></span>
<span><span class="co">#&gt; 6       SJF 6 6.783325  5.098680</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h2>
<p>Use <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">ggplot2::autoplot()</a></code> for a print out of various
standard diagnostic plots.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>Use [MARSS::residuals()] for the residuals.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   type .rownames  name t    value   .fitted   .resids    .sigma .std.resids</span></span>
<span><span class="co">#&gt; 1 ytt1       SJF model 1 6.033086 -8.280137 14.313223 1.4829561    9.651819</span></span>
<span><span class="co">#&gt; 2 ytt1       SJF model 2       NA  5.098680        NA        NA          NA</span></span>
<span><span class="co">#&gt; 3 ytt1       SJF model 3       NA  5.098680        NA        NA          NA</span></span>
<span><span class="co">#&gt; 4 ytt1       SJF model 4       NA  5.098680        NA        NA          NA</span></span>
<span><span class="co">#&gt; 5 ytt1       SJF model 5       NA  5.098680        NA        NA          NA</span></span>
<span><span class="co">#&gt; 6 ytt1       SJF model 6 6.783325  5.098680  1.684645 0.7115718    2.367498</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="predictions-and-forecasts">Predictions and forecasts<a class="anchor" aria-label="anchor" href="#predictions-and-forecasts"></a>
</h2>
<p>To produce predictions and forecasts from a MARSS model, see
[MARSS::predict.marssMLE()] or [MARSS::forecast.marssMLE()]</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/" class="external-link">forecast</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">pred</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   .rownames t        y estimate        se    Lo 80    Hi 80    Lo 95    Hi 95</span></span>
<span><span class="co">#&gt; 1       SJF 1 6.033086 5.115215 0.3565473 4.658281 5.572148 4.416395 5.814034</span></span>
<span><span class="co">#&gt; 2       SJF 2       NA 5.368349 0.4319516 4.814781 5.921918 4.521740 6.214959</span></span>
<span><span class="co">#&gt; 3       SJF 3       NA 5.621484 0.4650708 5.025472 6.217496 4.709962 6.533006</span></span>
<span><span class="co">#&gt; 4       SJF 4       NA 5.874619 0.4650290 5.278660 6.470578 4.963179 6.786059</span></span>
<span><span class="co">#&gt; 5       SJF 5       NA 6.127754 0.4318166 5.574358 6.681149 5.281409 6.974099</span></span>
<span><span class="co">#&gt; 6       SJF 6 6.783325 6.380888 0.3562747 5.924304 6.837473 5.682603 7.079174</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fr</span><span class="op">)</span></span></code></pre></div>
<p><img src="Quick_Start_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="output-to-latex">Output to LaTeX<a class="anchor" aria-label="anchor" href="#output-to-latex"></a>
</h2>
<p>[MARSS::toLatex.marssMLE()] allows you to create LaTeX for your model
that you can include in your files.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/toLatex.html" class="external-link">toLatex</a></span><span class="op">(</span><span class="va">fit</span>, output<span class="op">=</span><span class="st">"tex"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="important">Important<a class="anchor" aria-label="anchor" href="#important"></a>
</h2>
<p>Specification of a properly constrained model with a unique solution
is the responsibility of the user because the {MARSS} package has no way
to tell if you have specified an insufficiently constrained model.</p>
</div>
<div class="section level2">
<h2 id="tips-and-tricks">Tips and Tricks<a class="anchor" aria-label="anchor" href="#tips-and-tricks"></a>
</h2>
<p>Use [MARSS::autoplot()] to see a series of standard plots and
diagnostics for your model. Try [MARSS::MARSSinfo()] if you get errors
you don’t understand or fitting is taking a long time to converge. Use
<code>fit=FALSE</code> in your [MARSS()] call to set up a model without
fitting. Let’s say you do <code>fit &lt;- MARSS(..., fit=FALSE)</code>.
Now you can do <code>summary(fit$model)</code> to see what [MARSS()]
thinks you are trying to fit.</p>
<p>Let’s say you specified your model with some text short-cuts, like
<code>Q="unconstrained"</code>, but you want the list matrix form for a
next step. <code>a &lt;- summary(fit$model)</code> returns that list
(invisibly). Because the model argument of <code><a href="https://rdrr.io/pkg/MARSS/man/MARSS.html" class="external-link">MARSS()</a></code> will
understand a list of list matrices, you can pass in <code>model=a</code>
to specify the model.
<code>MARSSkfas(fit, return.kfas.model=TRUE)</code> will return your
model in {KFAS} format (class SSModel), thus you can use all the
functions available in the {KFAS} package on your model.</p>
</div>
<div class="section level2">
<h2 id="linear-constraints">Linear constraints<a class="anchor" aria-label="anchor" href="#linear-constraints"></a>
</h2>
<p>Not provided with {marssTMB}. See the {MARSS} package instead.</p>
</div>
<div class="section level2">
<h2 id="time-varying-parameters">Time-varying parameters<a class="anchor" aria-label="anchor" href="#time-varying-parameters"></a>
</h2>
<p>Not currently implemented in {marssTMB}. Use the {MARSS} package for
time-varying parameters.</p>
</div>
<div class="section level2">
<h2 id="need-more-information">Need more information?<a class="anchor" aria-label="anchor" href="#need-more-information"></a>
</h2>
<p>Lectures and more examples on fitting multivariate models can be
found at our course website [<a href="https://atsa-es.github.io/atsa" class="external-link uri">https://atsa-es.github.io/atsa</a>] and course eBook [<a href="https://atsa-es.github.io/atsa-labs" class="external-link uri">https://atsa-es.github.io/atsa-labs</a>].</p>
<p>The MARSS User Guide starts with some tutorials on MARSS models and
walks through many examples showing how to write multivariate
time-series models in MARSS form. The User Guide also has vignettes: how
to write AR(p) models in state-space form, dynamic linear models
(regression models where the regression parameters are AR(p)),
multivariate regression models with regression parameters that are
time-varying and enter the non-AR part of your model or the AR part,
detecting breakpoints using state-space models, and dynamic factor
analysis. All of these can be written in MARSS form. It also has a
series of vignettes on analysis of multivariate biological data.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Eli Holmes, Eric Ward, Timothy Cline.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
