<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Optimization discussion • marssTMB</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Optimization discussion">
<meta property="og:description" content="marssTMB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">marssTMB</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Quick_Start.html">Quick Start</a>
    </li>
    <li>
      <a href="../articles/MARSS_TMB.html">Dynamic Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/dfaTMB.html">dfaTMB: Dynamic Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/Optimization.html">Optimization discussion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atsa-es/marssTMB/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Optimization discussion</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atsa-es/marssTMB/blob/HEAD/vignettes/Optimization.Rmd" class="external-link"><code>vignettes/Optimization.Rmd</code></a></small>
      <div class="hidden name"><code>Optimization.Rmd</code></div>

    </div>

    
    
<p>Notes on the optimization and likelihood calculation functions.</p>
<div class="section level2">
<h2 id="optimization">Optimization<a class="anchor" aria-label="anchor" href="#optimization"></a>
</h2>
<p>All these functions take a function that returns the likelihood (and
potentially gradients) and finds the parameters that maximize that
likelihood. Technically they minimize the negative log-likelihood.</p>
<div class="section level3">
<h3 id="nlminb">nlminb<a class="anchor" aria-label="anchor" href="#nlminb"></a>
</h3>
<p>[stats::nlminb()] provides unconstrained and bounds-constrained
quasi-Newton optimization. This code is based on a FORTRAN PORT library
by David Gay in the Bell Labs designed to be portable over different
types of computer (from comments by Erwin Kalvelagen). See more here
(Section 2). Reference: J.E. Dennis, Jr., David M. Gay, Roy E. Welsch
(1981) An Adaptive Nonlinear Least-Squares Algorithm. ACM Transactions
on Mathematical Software 7:348-368 <a href="https://dl.acm.org/doi/pdf/10.1145/355958.355965" class="external-link">DOI</a>.</p>
</div>
<div class="section level3">
<h3 id="optim">optim<a class="anchor" aria-label="anchor" href="#optim"></a>
</h3>
<p>[stats::optim()] provides a variety of different optimatizaqtion
algorithms. Two of these are L-BFGS-B and BFGS, which are quasi-Newton
family methods. These are in the same class of algorithm as the nlminb
“adaptive nonlinear least-squares algorithm”.</p>
</div>
<div class="section level3">
<h3 id="marsskem">MARSSkem<a class="anchor" aria-label="anchor" href="#marsskem"></a>
</h3>
<p>[MARSS::MARSSkem()] provides a specific EM algorithm for linear
constrained MARSS models.</p>
</div>
</div>
<div class="section level2">
<h2 id="likelihood-calculation">Likelihood Calculation<a class="anchor" aria-label="anchor" href="#likelihood-calculation"></a>
</h2>
<p>MARSS and marssTMB provide three functions for likelihood
calculations.</p>
<div class="section level3">
<h3 id="koopman-and-durbin-kalman-filter-and-smoother">Koopman and Durbin Kalman filter and smoother<a class="anchor" aria-label="anchor" href="#koopman-and-durbin-kalman-filter-and-smoother"></a>
</h3>
<p>[MARSS::MARSSkfas()] uses the Koopman and Durbin (2001-2003)
modificatioon of the Kalman filter and smoother algorithms to compute
the maximum-likelihood estimates of the states. This algorithm is a more
robust and faster implementation than the classic (original) Kalman
filter and smoother equations. [MARSS::MARSSkfas()] uses the <a href="https://cran.r-project.org/package=KFAS" class="external-link">KFAS</a> package, which
provides a fast implementation of the Koopman and Durbin (2001-2003)
algorithms and the likelihood.</p>
</div>
<div class="section level3">
<h3 id="classic-kalman-filter-and-smoother">Classic Kalman filter and smoother<a class="anchor" aria-label="anchor" href="#classic-kalman-filter-and-smoother"></a>
</h3>
<p>[MARSS::MARSSkfss()] uses the classic Kalman filter and smoother and
innovations likelihood calculation with missing values modifications as
described in Shumway and Stoffer (2006). The classic recursions involve
matrix inversions that make this algorithm slower and less stable.</p>
</div>
<div class="section level3">
<h3 id="tmb">TMB<a class="anchor" aria-label="anchor" href="#tmb"></a>
</h3>
<p><a href="https://cran.r-project.org/package=TMB" class="external-link">TMB</a> uses applied
Laplace approximation to provide the gradients (exact derivatives) of a
likelihood surface that is a function of the states (X) and parameters.
It also returns the value of the likelihood surface at a set of states
and parameter values. The implementation is very fast and efficient.
These two elements (the gradients and likelihood) can then be given to
an optimization algorithm for fast calculation of the maximum likelihood
states (X) and parameters. [MARSStmb()] uses the output from TMB and
finds the maximum likelihood states and parameters via either
[stats::nlminb()] or [stats:optim()].</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Eli Holmes, Eric Ward, Timothy Cline.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
